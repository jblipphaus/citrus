<project name="flight-booking" basedir="." default="init" xmlns:artifact="urn:maven-artifact-ant">
	<property file="src/citrus/resources/citrus.properties"/>
	
	<target name="init">
	    <typedef resource="org/apache/maven/artifact/ant/antlib.xml" uri="urn:maven-artifact-ant">
	        <classpath>
	            <pathelement location="maven-ant-tasks-2.0.7.jar"/>
	        </classpath>
	    </typedef>
		
	    <artifact:dependencies pathId="citrus-classpath">
	        <dependency groupId="com.consol.citrus" artifactId="citrus-core" version="1.1-SNAPSHOT"/>
	    	<dependency groupId="com.consol.citrus" artifactId="citrus-tibco" version="1.1-SNAPSHOT"/>
	    	<dependency groupId="com.consol.citrus" artifactId="citrus-http" version="1.1-SNAPSHOT"/>
	    	<dependency groupId="hsqldb" artifactId="hsqldb" version="1.8.0.10"/>
	        <dependency groupId="org.slf4j" artifactId="slf4j-log4j12" version="1.5.6"/>
	    </artifact:dependencies>
	</target>
	
	<typedef resource="citrustasks" classpath="citrus-ant-tasks-1.0.jar"/>
	
	<target name="citrus.run.tests" depends="init">
	    <citrus suitename="citrus-samples" package="com.consol.citrus.*">
            <classpath path="src/main/resources"/>
	    </citrus>
	</target>
	
	<target name="citrus.run.single.test" depends="init">
   	 	<touch file="target/test.history"/>
    	
    	<loadproperties srcfile="target/test.history"/>
    	
    	<echo message="Last test executed: ${last.test.executed}"/>

    	<input message="Enter test name:" addproperty="testclass" defaultvalue="${last.test.executed}"/>
    	
    	<propertyfile file="target/test.history">
			<entry key="last.test.executed" type="string" value="${testclass}"/>
		</propertyfile>

		<citrus suitename="citrus-samples" test="${testclass}">
            <classpath path="src/main/resources"/>
        </citrus>
    </target>
	
	<target name="create.test" depends="init" description="Creates a new empty test">
        <input message="Enter test name:" addproperty="test.name"/>
        <input message="Enter test description:" addproperty="test.description"/>
        <input message="Enter author's name:" addproperty="test.author" defaultvalue="${default.test.author}"/>
        <input message="Enter package:" addproperty="test.package" defaultvalue="${default.test.package}"/>

		<java classname="com.consol.citrus.util.TestCaseCreator">
            <classpath refid="citrus-classpath"/>
            <arg value="${test.name}"/>
			<arg value="${test.author}"/>
			<arg value="${test.description}"/>
			<arg value="${test.package}"/>
        </java>
    </target>
	
</project>
