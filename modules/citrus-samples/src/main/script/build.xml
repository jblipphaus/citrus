<project name="flight-booking" basedir="." default="citrus.run.tests">
		
	<property file="src/citrus/resources/citrus.properties"/>
	
    <path id="citrus-classpath">
        <pathelement path="src/citrus/java"/>
        <fileset dir="../dist">
            <include name="*.jar"/>
        </fileset>
		<fileset dir="../lib">
            <include name="*.jar"/>
        </fileset>
    	<fileset dir="lib">
            <include name="*.jar"/>
        </fileset>
    </path>
    
	<typedef resource="citrustasks" classpath="lib/citrus-ant-tasks-1.0.jar"/>
	
	<target name="compile.tests">
	    <javac srcdir="src/citrus/java" classpathref="citrus-classpath"/>
		<javac srcdir="src/citrus/tests" classpathref="citrus-classpath"/>
	</target>
	
	<target name="citrus.run.tests" depends="compile.tests" description="Runs all Citrus tests">
		<citrus suitename="citrus-samples" package="com.consol.citrus.*"/>
	</target>
	
	<target name="citrus.run.single.test" depends="compile.tests" description="Runs a single test by name">
   	 	<touch file="test.history"/>
    	
    	<loadproperties srcfile="test.history"/>
    	
    	<echo message="Last test executed: ${last.test.executed}"/>

    	<input message="Enter test name:" addproperty="testclass" defaultvalue="${last.test.executed}"/>
    	
    	<propertyfile file="test.history">
			<entry key="last.test.executed" type="string" value="${testclass}"/>
		</propertyfile>

		<citrus suitename="citrus-samples" test="${testclass}"/>
    </target>
	
	<target name="create.test" description="Creates a new empty test case">
		<input message="Enter test name:" addproperty="test.name"/>
        <input message="Enter test description:" addproperty="test.description"/>
        <input message="Enter author's name:" addproperty="test.author" defaultvalue="${default.test.author}"/>
        <input message="Enter package:" addproperty="test.package" defaultvalue="${default.test.package}"/>

		<java classname="com.consol.citrus.util.TestCaseCreator">
            <classpath refid="citrus-classpath"/>
            <arg value="${test.name}"/>
			<arg value="${test.author}"/>
			<arg value="${test.description}"/>
			<arg value="${test.package}"/>
        </java>
    </target>
	
	<target name="create.html.doc" description="Creates test documentation in html">
        <mkdir dir="target"/>
        <mkdir dir="target/img"/>
        
        <java classname="com.consol.citrus.doc.HtmlTestDocGenerator">
            <classpath refid="citrus-classpath" />    
            
            <arg value="src/citrus/tests"/>
            <arg value="target/CitrusTests.html"/>
            <arg value="Citrus Test Documentation"/>
            <arg value="img/logo.png"/>
            <arg value="Overview"/>
        </java>
        
        <copy todir="target/img" file="src/citrus/resources/logo.png"/>
        
        <zip destfile="target/CitrusTests.zip">
            <fileset dir="target">
                <include name="*.html"/>
                <include name="img/*"/>
            </fileset>
        </zip>
    </target>
    
    <target name="create.xls.doc" description="Creates test documentation in excel">
        <mkdir dir="target"/>
        
        <java classname="com.consol.citrus.doc.ExcelTestDocGenerator">
            <classpath refid="citrus-classpath" />
            
            <arg value="src/citrus/tests"/>
            <arg value="target/CitrusTests.xls"/>
            <arg value="Citrus Test Documentation"/>
            <arg value="Citrus Testframework"/>
            <arg value="ConSol* Software GmbH"/>
        </java>
    </target>
</project>
